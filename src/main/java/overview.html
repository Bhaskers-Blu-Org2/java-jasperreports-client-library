<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
</head>
<body bgcolor="white">

<p>
A simple Java library for integrating DeployR capabilities into Jaspersoft's JasperReports Server BI Suite.
<p>
<b>1. RQueryExecuter</b>
<br/><br/>
This library provides an implementation of a DeployR-aware JRQueryExecuter. This query executer generates an <i>RDataSource</i>. This data source can be used to integrate R session data generated by a DeployR R Script execution into a Jasper Report.
<br/><br/>
<p>
<b>2. Custom Query Language: deployrScript</b>
<br/><br/>
The DeployR-aware custom Query Executer supports a new custom query language, <i>deployrScript</i>.
<br/><br/>
This query language allows the report user to configure and connect to a DeployR-aware JRDataSource. The following is an example of a <i>deployrScript</i> report Query string:
<br/>
<pre>
{@code
<deployr url="http://localhost:7300/deployr">
    <script filename="Histogram of Auto Sales" directory="sample" author="testuser"/>
    <preload>
        <workspace repo="testuser" directory="sample" name="dataset.rData"/>
        <directory repo="testuser" directory="sample" name="population.csv" version="1327229341753"/>
    </preload>
    <robjects>
        <robject name="title"/>
        <robject name="sales"/>
        <robject name="forecasts"/>
    </robjects>
    <authentication username="testuser" password="secret"/>
</deployr>
}
</pre>
The <i>preload</i>, <i>robjects</i> and <i>authentication</i> elements in this query markup are all optional and should be set according to the specific needs of the report and the R Script being executed. Within the <i>preload</i> element both the <i>workspace</i> and <i>directory</i> elements are optional and the <i>version</i> attribute on those two elements is also optional.
<p><br/>
<b>3. Defining Report Fields using the RDataSource</b>
<br/><br/>
The DeployR-aware DataSource exposes a single record that can be queried for R session data returned on the execution of an R Script. 
<br/><br/>
Each data item present on the DataSource can be referenced by a unique <i>identifier</i>. Each data item also has an associated data <i>type</i>. By combining  <i>type</i> and <i>identifier</i> in a simple query syntax a report designer can extract data from the DataSource for rendering. The query syntax language is detailed here:
<br/><br/>
For each field in the report the <i>Description</i> property should be specified as follows:
<br/><br/>
<i>type</i> <b>:</b> <i>identifier</i> <b>:</b> <i>optional-attributes</i>
<br/><br/>
<b>3a. Primitive data types</b> that can be indicated by <i>type</i>, are listed here:
<br/><br/>
string, integer, double, boolean, date
<br/><br/>
Example: Defining a field with description property of <i>string:title</i> would extract the item <i>title</i> from the data source for rendering.
<br/><br/>
<b>3b. Collection data types</b> that can be indicated by <i>type</i>, are listed here:
<br/><br/>
vector, matrix, factor
<br/><br/>
Vector and factor types take an <i>index</i> as an optional-attribute that indexes into the vector to retrieve a specific value. Matrix types take a <i>row</i> and an <i>index</i> as optional-attributes that index into the matrix to retrieve a specific value. If these optional-attributes are omitted on the field description then the complete List for the collection is returned.
<br/><br/>
Example: Defining a field with description property of <i>vector:sales:0</i> would extract the vector item <i>sales</i> from the data source and render the first data element.
<br/><br/>
<b>3c. Complex data types</b> that can be indicated by <i>type</i>, are listed here:
<br/><br/>
list, dataframe
<br/><br/>
Complex data types do not themselves represent data but rather they encapsulate data. To access data encapsulated in a complex data type simply apply the query syntax recursively.
<br/><br/>
Example: Defining a field with description property of <i>dataframe:forecasts:vector:quaterly:4</i> would extract the data associated with the <i>quaterly</i> vector that is encapsulated within the <i>forecasts</i> dataframe.
<br/><br/>
<b>3d. File data type.</b> There is one single <i>file</i> type that can be specified to return the URL string for the item indicated by <i>identifier</i>.
<br/><br/>
Example: Defining a field with description property of <i>file:sales.png</i> would extract the URL string of the file indicated.
<br/><br/>
<p>
<b>4. Handling R Script Inputs as Report Parameters</b>
<br/><br/>
There are times when a user might want to supply additional data that will be passed as inputs on an R Script such as a flag indicating a condition that determines the path of execution in the R Script.
<br/><br/>
These inputs are supported by Revolution Report Parameters (RRP). A RQueryExecuter based report can specify any number of DeployR-specific report parameters that can be relayed as inputs to the R Script. These DeployR-specific report parameters are identified by prefixing <i>RRP_</i> ahead of each parameter name in the report definition.
<br/><br/>
Example: An R Script expects two inputs: a boolean flag and a number, let's call them <i>retired</i> and <i>age</i> respectively. These inputs configure the behavior of the script each time it is run. To specify these report parameters in order that they will be identified and forwarded to the R Script each named parameter needs to be prefixed with <i>RRP_</i>.
<br/><br/>
The required report parameter names would then be <i>RRP_retired</i> and <i>RRP_age</i> respectively. As these report parameters are expected to be supplied by the user only primitive types for these parameters are allowed.
<br/><br/>
<p>
<b>5. Changes from the Jaspersoft-DeployR BI 1.0 Client Library release</b>
<br/><br/>
The <i>preload</i> attribute on the <i>deployr</i> element in the 1.0 release has been replaced with a new <i>preload</i> element as indicated above. This new element supports the preloading of binary R data directly into the workspace using the <i>workspace</i> element and the preloading of file data into the working directory of the R session using the <i>directory</i> element.
<br/><br/>
The <i>files</i> element supported in the 1.0 release is no longer required. Now any named file artifact created by the execution of the R script can be referenced simply by using the <i>file</i> type as detailed above.
<br/><br/>
</body>
</html>
